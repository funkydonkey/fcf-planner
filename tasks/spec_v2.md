# üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –ó–∞–¥–∞–Ω–∏–µ: Cash Flow Planner v2.0
## Driver-Based Forecasting —Å AI

**–í–µ—Ä—Å–∏—è:** 2.0  
**–î–∞—Ç–∞:** –§–µ–≤—Ä–∞–ª—å 2026  
**–ê–≤—Ç–æ—Ä:** Andrey + Claude  

---

## 1. üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–†–∞–∑–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π Cash Flow Planner –æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ trend-based –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º—É **driver-based forecasting** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AI.

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (v1.0)
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (CSV/Excel)
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π AI-–ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–µ–Ω–¥–∞ –∏ —Å—Ä–µ–¥–Ω–µ–≥–æ
- ‚úÖ –†—É—á–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤ –ë–î

### –¶–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (v2.0)
- üéØ –í–≤–æ–¥ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤ (DSO, DPO, DIO, Revenue Growth –∏ –¥—Ä.)
- üéØ –†–∞—Å—á—ë—Ç CCC (Cash Conversion Cycle) 
- üéØ AI-–ø—Ä–æ–≥–Ω–æ–∑ —Å —É—á—ë—Ç–æ–º –¥—Ä–∞–π–≤–µ—Ä–æ–≤
- üéØ –°—Ü–µ–Ω–∞—Ä–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (what-if analysis)
- üéØ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞

---

## 2. üìä –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã Cash Flow

### 2.1 –û—Å–Ω–æ–≤–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã Working Capital

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   CASH CONVERSION CYCLE                      ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ   CCC = DSO + DIO - DPO                                     ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                ‚îÇ
‚îÇ   ‚îÇ   DIO   ‚îÇ +  ‚îÇ   DSO   ‚îÇ -  ‚îÇ   DPO   ‚îÇ = CCC          ‚îÇ
‚îÇ   ‚îÇ –ó–∞–ø–∞—Å—ã  ‚îÇ    ‚îÇ –î–µ–±–∏—Ç–æ—Ä ‚îÇ    ‚îÇ –ö—Ä–µ–¥–∏—Ç  ‚îÇ                ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ   –ß–µ–º –º–µ–Ω—å—à–µ CCC ‚Üí —Ç–µ–º –±—ã—Å—Ç—Ä–µ–µ –¥–µ–Ω—å–≥–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2.2 –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥—Ä–∞–π–≤–µ—Ä–æ–≤

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –î—Ä–∞–π–≤–µ—Ä | –í–ª–∏—è–Ω–∏–µ –Ω–∞ Cash Flow |
|-----------|---------|---------------------|
| **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ** | Revenue Growth % | ‚Üë Revenue ‚Üí ‚Üë AR ‚Üí ‚Üì Cash (–≤—Ä–µ–º–µ–Ω–Ω–æ) |
| | Gross Margin % | ‚Üë Margin ‚Üí ‚Üë Operating Cash |
| | COGS % | ‚Üë COGS ‚Üí ‚Üì Operating Cash |
| **Working Capital** | DSO (–¥–Ω–∏) | ‚Üë DSO ‚Üí ‚Üì Cash (–¥–µ–Ω—å–≥–∏ –≤ –¥–µ–±–∏—Ç–æ—Ä–∫–µ) |
| | DPO (–¥–Ω–∏) | ‚Üë DPO ‚Üí ‚Üë Cash (–æ—Ç—Å—Ä–æ—á–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π) |
| | DIO (–¥–Ω–∏) | ‚Üë DIO ‚Üí ‚Üì Cash (–¥–µ–Ω—å–≥–∏ –≤ –∑–∞–ø–∞—Å–∞—Ö) |
| **CapEx** | CapEx % –æ—Ç Revenue | ‚Üë CapEx ‚Üí ‚Üì Cash |
| **–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ** | Interest Rate % | ‚Üë Rate ‚Üí ‚Üì Cash (–ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã) |
| | Debt Repayment | –ü–æ–≥–∞—à–µ–Ω–∏–µ –¥–æ–ª–≥–∞ ‚Üí ‚Üì Cash |
| **–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å** | Seasonal Factor | –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ –º–µ—Å—è—Ü–∞–º |

### 2.3 –§–æ—Ä–º—É–ª—ã —Ä–∞—Å—á—ë—Ç–∞ Cash Flow

```python
# Operating Cash Flow (Indirect Method)
Operating_CF = Net_Income + Depreciation - Œî_Working_Capital

# –ì–¥–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ Working Capital:
Œî_Working_Capital = Œî_AR + Œî_Inventory - Œî_AP

# AR (Accounts Receivable) —á–µ—Ä–µ–∑ DSO:
AR = (Revenue / 365) * DSO

# AP (Accounts Payable) —á–µ—Ä–µ–∑ DPO:
AP = (COGS / 365) * DPO

# Inventory —á–µ—Ä–µ–∑ DIO:
Inventory = (COGS / 365) * DIO

# Free Cash Flow
Free_CF = Operating_CF - CapEx
```

---

## 3. üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã v2.0

### 3.1 –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        STREAMLIT UI                            ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ –ó–∞–≥—Ä—É–∑–∫–∞ ‚îÇ  ‚îÇ –î—Ä–∞–π–≤–µ—Ä—ã ‚îÇ  ‚îÇ –°—Ü–µ–Ω–∞—Ä–∏–∏ ‚îÇ  ‚îÇ –î–∞—à–±–æ—Ä–¥  ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  –¥–∞–Ω–Ω—ã—Ö  ‚îÇ  ‚îÇ  –≤–≤–æ–¥    ‚îÇ  ‚îÇ  what-if ‚îÇ  ‚îÇ          ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ             ‚îÇ             ‚îÇ             ‚îÇ
        v             v             v             v
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      CORE SERVICES                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ DataLoader   ‚îÇ  ‚îÇ DriverEngine ‚îÇ  ‚îÇ Forecaster   ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ              ‚îÇ  ‚îÇ              ‚îÇ  ‚îÇ              ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ - CSV/Excel  ‚îÇ  ‚îÇ - DSO/DPO/DIO‚îÇ  ‚îÇ - AI Agent   ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ - Validation ‚îÇ  ‚îÇ - CCC Calc   ‚îÇ  ‚îÇ - Scenarios  ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ                 ‚îÇ                 ‚îÇ
          v                 v                 v
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         AI LAYER                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ                    Multi-Agent System                     ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ Analyst ‚îÇ ‚Üí ‚îÇ Driver  ‚îÇ ‚Üí ‚îÇForecast ‚îÇ ‚Üí ‚îÇExplainer‚îÇ  ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ Agent   ‚îÇ   ‚îÇ Agent   ‚îÇ   ‚îÇ Agent   ‚îÇ   ‚îÇ Agent   ‚îÇ  ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          v
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                       DATA LAYER                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ   SQLite     ‚îÇ  ‚îÇ   Scenarios  ‚îÇ  ‚îÇ   History    ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ   Database   ‚îÇ  ‚îÇ   Storage    ‚îÇ  ‚îÇ   Cache      ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 3.2 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ v2.0

```
fcf_planner/
‚îú‚îÄ‚îÄ app.py                          # –ì–ª–∞–≤–Ω–æ–µ Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ config.py                       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ core/                           # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (—Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
‚îÇ   ‚îú‚îÄ‚îÄ io_historical.py            # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ data_transform.py           # –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ db.py                       # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ models.py                   # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ
‚îú‚îÄ‚îÄ drivers/                        # üÜï –ù–û–í–´–ô –ú–û–î–£–õ–¨
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ models.py                   # Pydantic –º–æ–¥–µ–ª–∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ calculator.py               # –†–∞—Å—á—ë—Ç DSO/DPO/DIO/CCC
‚îÇ   ‚îú‚îÄ‚îÄ validator.py                # –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ defaults.py                 # –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –∏–Ω–¥—É—Å—Ç—Ä–∏—è–º
‚îÇ
‚îú‚îÄ‚îÄ forecasting/                    # üÜï –ù–û–í–´–ô –ú–û–î–£–õ–¨
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ driver_based.py             # Driver-based –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ scenarios.py                # –°—Ü–µ–Ω–∞—Ä–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ sensitivity.py              # –ê–Ω–∞–ª–∏–∑ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚îÇ
‚îú‚îÄ‚îÄ ai_agents/                      # AI –∞–≥–µ–Ω—Ç—ã (—Ä–∞—Å—à–∏—Ä—è–µ–º)
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ forecast_agent.py           # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∞–≥–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ forecast_analyzer.py        # –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
‚îÇ   ‚îú‚îÄ‚îÄ driver_agent.py             # üÜï –ê–Ω–∞–ª–∏–∑ –¥—Ä–∞–π–≤–µ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ scenario_agent.py           # üÜï –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
‚îÇ   ‚îî‚îÄ‚îÄ explainer_agent.py          # üÜï –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ ui/                             # üÜï UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ driver_input.py             # –§–æ—Ä–º—ã –≤–≤–æ–¥–∞ –¥—Ä–∞–π–≤–µ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ scenario_builder.py         # –ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
‚îÇ   ‚îî‚îÄ‚îÄ dashboard.py                # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ
‚îî‚îÄ‚îÄ data/
    ‚îú‚îÄ‚îÄ sample_cashflow.csv
    ‚îî‚îÄ‚îÄ industry_benchmarks.json    # üÜï –ë–µ–Ω—á–º–∞—Ä–∫–∏ –ø–æ –∏–Ω–¥—É—Å—Ç—Ä–∏—è–º
```

---

## 4. üìù –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### 4.1 Pydantic –º–æ–¥–µ–ª–∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤

```python
# drivers/models.py

from pydantic import BaseModel, Field
from typing import Optional, List
from enum import Enum

class Industry(str, Enum):
    """–ò–Ω–¥—É—Å—Ç—Ä–∏–∏ –¥–ª—è –±–µ–Ω—á–º–∞—Ä–∫–æ–≤"""
    RETAIL = "retail"
    MANUFACTURING = "manufacturing"
    SERVICES = "services"
    TECHNOLOGY = "technology"
    HEALTHCARE = "healthcare"

class WorkingCapitalDrivers(BaseModel):
    """–î—Ä–∞–π–≤–µ—Ä—ã –æ–±–æ—Ä–æ—Ç–Ω–æ–≥–æ –∫–∞–ø–∏—Ç–∞–ª–∞"""
    dso_days: float = Field(ge=0, le=365, description="Days Sales Outstanding")
    dpo_days: float = Field(ge=0, le=365, description="Days Payable Outstanding")
    dio_days: float = Field(ge=0, le=365, description="Days Inventory Outstanding")
    
    @property
    def ccc_days(self) -> float:
        """Cash Conversion Cycle"""
        return self.dso_days + self.dio_days - self.dpo_days

class RevenueDrivers(BaseModel):
    """–î—Ä–∞–π–≤–µ—Ä—ã –≤—ã—Ä—É—á–∫–∏"""
    revenue_growth_pct: float = Field(ge=-100, le=500, description="–†–æ—Å—Ç –≤—ã—Ä—É—á–∫–∏ %")
    gross_margin_pct: float = Field(ge=0, le=100, description="–í–∞–ª–æ–≤–∞—è –º–∞—Ä–∂–∞ %")
    seasonality_factors: Optional[List[float]] = Field(
        default=None, 
        description="12 –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏ (–ø–æ –º–µ—Å—è—Ü–∞–º)"
    )

class CapExDrivers(BaseModel):
    """–î—Ä–∞–π–≤–µ—Ä—ã –∫–∞–ø–∏—Ç–∞–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç"""
    capex_pct_of_revenue: float = Field(ge=0, le=100, description="CapEx –∫–∞–∫ % –æ—Ç –≤—ã—Ä—É—á–∫–∏")
    depreciation_years: int = Field(ge=1, le=40, description="–°—Ä–æ–∫ –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–∏")

class FinancingDrivers(BaseModel):
    """–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã"""
    interest_rate_pct: float = Field(ge=0, le=50, description="–ü—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞")
    debt_to_equity: float = Field(ge=0, le=10, description="–î–æ–ª–≥/–ö–∞–ø–∏—Ç–∞–ª")
    tax_rate_pct: float = Field(ge=0, le=50, description="–°—Ç–∞–≤–∫–∞ –Ω–∞–ª–æ–≥–∞")

class ForecastDrivers(BaseModel):
    """–ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞"""
    working_capital: WorkingCapitalDrivers
    revenue: RevenueDrivers
    capex: Optional[CapExDrivers] = None
    financing: Optional[FinancingDrivers] = None
    industry: Optional[Industry] = None
    
    class Config:
        json_schema_extra = {
            "example": {
                "working_capital": {
                    "dso_days": 45,
                    "dpo_days": 30,
                    "dio_days": 60
                },
                "revenue": {
                    "revenue_growth_pct": 10,
                    "gross_margin_pct": 35
                }
            }
        }
```

### 4.2 SQLAlchemy –º–æ–¥–µ–ª–∏ (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)

```python
# core/models.py (–¥–æ–±–∞–≤–ª—è–µ–º)

class ScenarioDrivers(Base):
    """–î—Ä–∞–π–≤–µ—Ä—ã –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏—è"""
    __tablename__ = 'scenario_drivers'
    
    id = Column(Integer, primary_key=True)
    scenario_id = Column(Integer, ForeignKey('scenarios.id'), nullable=False)
    
    # Working Capital
    dso_days = Column(Float, nullable=False)
    dpo_days = Column(Float, nullable=False)
    dio_days = Column(Float, nullable=False)
    ccc_days = Column(Float, nullable=False)  # –†–∞—Å—á—ë—Ç–Ω–æ–µ
    
    # Revenue
    revenue_growth_pct = Column(Float, nullable=False)
    gross_margin_pct = Column(Float, nullable=False)
    
    # Optional
    capex_pct = Column(Float, nullable=True)
    interest_rate_pct = Column(Float, nullable=True)
    
    scenario = relationship("Scenario", back_populates="drivers")
```

---

## 5. ü§ñ AI –ê–≥–µ–Ω—Ç—ã

### 5.1 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Multi-Agent System

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    ORCHESTRATOR AGENT                        ‚îÇ
‚îÇ              (–ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –∞–≥–µ–Ω—Ç–æ–≤)                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                 ‚îÇ                 ‚îÇ
        v                 v                 v
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ANALYST AGENT ‚îÇ ‚îÇ DRIVER AGENT  ‚îÇ ‚îÇ EXPLAINER     ‚îÇ
‚îÇ               ‚îÇ ‚îÇ               ‚îÇ ‚îÇ AGENT         ‚îÇ
‚îÇ - –ê–Ω–∞–ª–∏–∑      ‚îÇ ‚îÇ - –í–∞–ª–∏–¥–∞—Ü–∏—è   ‚îÇ ‚îÇ               ‚îÇ
‚îÇ   –∏—Å—Ç–æ—Ä–∏–∏     ‚îÇ ‚îÇ   –¥—Ä–∞–π–≤–µ—Ä–æ–≤   ‚îÇ ‚îÇ - –¢–µ–∫—Å—Ç–æ–≤–æ–µ   ‚îÇ
‚îÇ - –í—ã—è–≤–ª–µ–Ω–∏–µ   ‚îÇ ‚îÇ - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ   ‚îÇ ‚îÇ   –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ  ‚îÇ
‚îÇ   –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤   ‚îÇ ‚îÇ   —Å –±–µ–Ω—á–º–∞—Ä–∫. ‚îÇ ‚îÇ   –ø—Ä–æ–≥–Ω–æ–∑–∞    ‚îÇ
‚îÇ - –ê–Ω–æ–º–∞–ª–∏–∏    ‚îÇ ‚îÇ - –†–µ–∫–æ–º–µ–Ω–¥.   ‚îÇ ‚îÇ - –†–∏—Å–∫–∏       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                 ‚îÇ                 ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
                          v
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ  FORECAST AGENT   ‚îÇ
                ‚îÇ                   ‚îÇ
                ‚îÇ - Driver-based    ‚îÇ
                ‚îÇ   —Ä–∞—Å—á—ë—Ç—ã         ‚îÇ
                ‚îÇ - –°—Ü–µ–Ω–∞—Ä–∏–∏        ‚îÇ
                ‚îÇ - Monte Carlo     ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 5.2 Driver Agent (–Ω–æ–≤—ã–π)

```python
# ai_agents/driver_agent.py

from agents import Agent, Runner
from pydantic import BaseModel
from typing import List, Optional
import json

class DriverRecommendation(BaseModel):
    """–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ –¥—Ä–∞–π–≤–µ—Ä—É"""
    driver_name: str
    current_value: float
    recommended_value: float
    industry_benchmark: float
    impact_on_cashflow: str
    reasoning: str

class DriverAnalysisResponse(BaseModel):
    """–û—Ç–≤–µ—Ç –∞–≥–µ–Ω—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞ –¥—Ä–∞–π–≤–µ—Ä–æ–≤"""
    recommendations: List[DriverRecommendation]
    overall_assessment: str
    risk_factors: List[str]
    opportunities: List[str]

class DriverAgent:
    """
    AI –∞–≥–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤
    –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–º–∏ –±–µ–Ω—á–º–∞—Ä–∫–∞–º–∏
    """
    
    def __init__(self):
        self.agent = Agent(
            name="driver_analyst",
            model="gpt-4o-mini",
            instructions="""
            –¢—ã - —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π—Å—è –Ω–∞ –∞–Ω–∞–ª–∏–∑–µ 
            –æ–±–æ—Ä–æ—Ç–Ω–æ–≥–æ –∫–∞–ø–∏—Ç–∞–ª–∞ –∏ cash flow.
            
            –¢–≤–æ–∏ –∑–∞–¥–∞—á–∏:
            1. –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥—Ä–∞–π–≤–µ—Ä–æ–≤ (DSO, DPO, DIO)
            2. –°—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Å –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–º–∏ –±–µ–Ω—á–º–∞—Ä–∫–∞–º–∏
            3. –í—ã—è–≤–ª—è—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
            4. –î–∞–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é cash flow
            
            –ü—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ —É—á–∏—Ç—ã–≤–∞–π:
            - –í—ã—Å–æ–∫–∏–π DSO = –¥–µ–Ω—å–≥–∏ –∑–∞—Å—Ç—Ä—è–ª–∏ –≤ –¥–µ–±–∏—Ç–æ—Ä–∫–µ
            - –ù–∏–∑–∫–∏–π DPO = –ø–ª–∞—Ç–∏–º —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ
            - –í—ã—Å–æ–∫–∏–π DIO = —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø–∞—Å–æ–≤
            - CCC = DSO + DIO - DPO (—á–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –ª—É—á—à–µ)
            
            –û—Ç–≤–µ—á–∞–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Ü–∏—Ñ—Ä–∞–º–∏.
            """,
            output_type=DriverAnalysisResponse
        )
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –±–µ–Ω—á–º–∞—Ä–∫–∏
        self.benchmarks = self._load_benchmarks()
    
    def _load_benchmarks(self) -> dict:
        """–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–µ –±–µ–Ω—á–º–∞—Ä–∫–∏"""
        return {
            "retail": {"dso": 15, "dpo": 30, "dio": 45},
            "manufacturing": {"dso": 45, "dpo": 40, "dio": 60},
            "services": {"dso": 35, "dpo": 25, "dio": 5},
            "technology": {"dso": 50, "dpo": 35, "dio": 20},
        }
    
    async def analyze_drivers(
        self, 
        drivers: dict, 
        industry: str,
        historical_data: Optional[dict] = None
    ) -> DriverAnalysisResponse:
        """
        –ê–Ω–∞–ª–∏–∑ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
        """
        benchmark = self.benchmarks.get(industry, self.benchmarks["services"])
        
        message = f"""
        –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–µ–∫—É—â–∏–µ –¥—Ä–∞–π–≤–µ—Ä—ã –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –¥–∞–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
        
        –¢–ï–ö–£–©–ò–ï –ó–ù–ê–ß–ï–ù–ò–Ø:
        - DSO: {drivers['dso_days']} –¥–Ω–µ–π
        - DPO: {drivers['dpo_days']} –¥–Ω–µ–π  
        - DIO: {drivers['dio_days']} –¥–Ω–µ–π
        - CCC: {drivers['dso_days'] + drivers['dio_days'] - drivers['dpo_days']} –¥–Ω–µ–π
        
        –ë–ï–ù–ß–ú–ê–†–ö–ò –î–õ–Ø –ò–ù–î–£–°–¢–†–ò–ò "{industry}":
        - DSO: {benchmark['dso']} –¥–Ω–µ–π
        - DPO: {benchmark['dpo']} –¥–Ω–µ–π
        - DIO: {benchmark['dio']} –¥–Ω–µ–π
        
        {f"–ò–°–¢–û–†–ò–ß–ï–°–ö–ê–Ø –î–ò–ù–ê–ú–ò–ö–ê: {json.dumps(historical_data)}" if historical_data else ""}
        
        –î–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –∫–∞–∂–¥–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞
        –∏ –æ—Ü–µ–Ω–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ cash flow.
        """
        
        result = await Runner.run(self.agent, message)
        return result.final_output
```

### 5.3 Explainer Agent (–Ω–æ–≤—ã–π)

```python
# ai_agents/explainer_agent.py

from agents import Agent, Runner
from pydantic import BaseModel
from typing import List

class ForecastExplanation(BaseModel):
    """–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞"""
    summary: str
    key_drivers: List[str]
    assumptions: List[str]
    risks: List[str]
    confidence_level: str  # "high", "medium", "low"
    recommendation: str

class ExplainerAgent:
    """
    AI –∞–≥–µ–Ω—Ç –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ 
    —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–º —è–∑—ã–∫–æ–º
    """
    
    def __init__(self):
        self.agent = Agent(
            name="forecast_explainer",
            model="gpt-4o-mini",
            instructions="""
            –¢—ã - —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä—è—Å–Ω—è–µ—Ç 
            —Å–ª–æ–∂–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º –¥–ª—è –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞.
            
            –¢–≤–æ—è –∑–∞–¥–∞—á–∞:
            1. –†–µ–∑—é–º–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ –≤ 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö
            2. –í—ã–¥–µ–ª–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π
            3. –ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–æ–ø—É—â–µ–Ω–∏—è
            4. –ü—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å –æ —Ä–∏—Å–∫–∞—Ö
            5. –û—Ü–µ–Ω–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–æ–≥–Ω–æ–∑–µ
            6. –î–∞—Ç—å –∏—Ç–æ–≥–æ–≤—É—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é
            
            –ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–æ—Å—Ç–æ–π —è–∑—ã–∫ –±–µ–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∂–∞—Ä–≥–æ–Ω–∞.
            –ü—Ä–∏–≤–æ–¥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ü–∏—Ñ—Ä—ã –∏ –ø—Ä–æ—Ü–µ–Ω—Ç—ã.
            """,
            output_type=ForecastExplanation
        )
    
    async def explain_forecast(
        self,
        forecast_data: dict,
        drivers: dict,
        historical_context: dict
    ) -> ForecastExplanation:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞"""
        
        message = f"""
        –û–±—ä—è—Å–Ω–∏ —ç—Ç–æ—Ç –ø—Ä–æ–≥–Ω–æ–∑ cash flow –¥–ª—è —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞:
        
        –ü–†–û–ì–ù–û–ó:
        {forecast_data}
        
        –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ù–´–ï –î–†–ê–ô–í–ï–†–´:
        {drivers}
        
        –ò–°–¢–û–†–ò–ß–ï–°–ö–ò–ô –ö–û–ù–¢–ï–ö–°–¢:
        {historical_context}
        
        –û–±—ä—è—Å–Ω–∏ –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —ç—Ç–æ—Ç –ø—Ä–æ–≥–Ω–æ–∑,
        –∫–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –Ω–∞ –Ω–µ–≥–æ –≤–ª–∏—è—é—Ç –∏ —á—Ç–æ –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å.
        """
        
        result = await Runner.run(self.agent, message)
        return result.final_output
```

---

## 6. üî¢ –ê–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–∞—Å—á—ë—Ç–∞

### 6.1 Driver-Based Cash Flow Calculation

```python
# forecasting/driver_based.py

import pandas as pd
import numpy as np
from typing import Dict, List, Optional
from drivers.models import ForecastDrivers

class DriverBasedForecaster:
    """
    –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ Cash Flow –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥—Ä–∞–π–≤–µ—Ä–æ–≤
    """
    
    def __init__(self, drivers: ForecastDrivers):
        self.drivers = drivers
    
    def forecast_working_capital(
        self, 
        revenue: float, 
        cogs: float
    ) -> Dict[str, float]:
        """
        –†–∞—Å—á—ë—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Working Capital
        
        Args:
            revenue: –í—ã—Ä—É—á–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥
            cogs: –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥
            
        Returns:
            Dict —Å AR, AP, Inventory –∏ –∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
        """
        wc = self.drivers.working_capital
        
        # –†–∞—Å—á—ë—Ç –±–∞–ª–∞–Ω—Å–æ–≤—ã—Ö —Å—Ç–∞—Ç–µ–π
        accounts_receivable = (revenue / 365) * wc.dso_days
        accounts_payable = (cogs / 365) * wc.dpo_days
        inventory = (cogs / 365) * wc.dio_days
        
        # Net Working Capital
        nwc = accounts_receivable + inventory - accounts_payable
        
        return {
            "accounts_receivable": accounts_receivable,
            "accounts_payable": accounts_payable,
            "inventory": inventory,
            "net_working_capital": nwc,
            "ccc_days": wc.ccc_days
        }
    
    def forecast_operating_cashflow(
        self,
        revenue: float,
        previous_revenue: float,
        cogs: float,
        previous_cogs: float,
        depreciation: float = 0
    ) -> Dict[str, float]:
        """
        –†–∞—Å—á—ë—Ç Operating Cash Flow (–∫–æ—Å–≤–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥)
        
        OCF = Net Income + Depreciation - Œî Working Capital
        """
        # –¢–µ–∫—É—â–∏–π –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π Working Capital
        current_wc = self.forecast_working_capital(revenue, cogs)
        previous_wc = self.forecast_working_capital(previous_revenue, previous_cogs)
        
        # –ò–∑–º–µ–Ω–µ–Ω–∏–µ Working Capital
        delta_wc = current_wc["net_working_capital"] - previous_wc["net_working_capital"]
        
        # Net Income (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)
        gross_profit = revenue * (self.drivers.revenue.gross_margin_pct / 100)
        
        # Operating Cash Flow
        operating_cf = gross_profit + depreciation - delta_wc
        
        return {
            "gross_profit": gross_profit,
            "depreciation": depreciation,
            "delta_working_capital": delta_wc,
            "delta_ar": current_wc["accounts_receivable"] - previous_wc["accounts_receivable"],
            "delta_ap": current_wc["accounts_payable"] - previous_wc["accounts_payable"],
            "delta_inventory": current_wc["inventory"] - previous_wc["inventory"],
            "operating_cashflow": operating_cf
        }
    
    def forecast_free_cashflow(
        self,
        operating_cf: float,
        revenue: float
    ) -> Dict[str, float]:
        """
        –†–∞—Å—á—ë—Ç Free Cash Flow
        
        FCF = Operating CF - CapEx
        """
        if self.drivers.capex:
            capex = revenue * (self.drivers.capex.capex_pct_of_revenue / 100)
        else:
            capex = 0
        
        fcf = operating_cf - capex
        
        return {
            "capex": capex,
            "free_cashflow": fcf
        }
    
    def generate_forecast(
        self,
        historical_data: pd.DataFrame,
        periods: int = 12
    ) -> pd.DataFrame:
        """
        –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∞ –Ω–∞ N –ø–µ—Ä–∏–æ–¥–æ–≤
        
        Args:
            historical_data: DataFrame —Å –∏—Å—Ç–æ—Ä–∏–µ–π (revenue, cogs, ...)
            periods: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–∏–æ–¥–æ–≤ –ø—Ä–æ–≥–Ω–æ–∑–∞
            
        Returns:
            DataFrame —Å –ø—Ä–æ–≥–Ω–æ–∑–æ–º
        """
        # –ë–∞–∑–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
        last_revenue = historical_data['revenue'].iloc[-1]
        last_cogs = historical_data['cogs'].iloc[-1] if 'cogs' in historical_data else last_revenue * 0.65
        
        forecasts = []
        
        for i in range(periods):
            # –†–æ—Å—Ç –≤—ã—Ä—É—á–∫–∏
            growth = 1 + (self.drivers.revenue.revenue_growth_pct / 100) / 12
            revenue = last_revenue * growth
            cogs = revenue * (1 - self.drivers.revenue.gross_margin_pct / 100)
            
            # –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å
            if self.drivers.revenue.seasonality_factors:
                month_idx = i % 12
                revenue *= self.drivers.revenue.seasonality_factors[month_idx]
            
            # Working Capital
            wc = self.forecast_working_capital(revenue, cogs)
            
            # Operating CF
            ocf = self.forecast_operating_cashflow(
                revenue, last_revenue,
                cogs, last_cogs,
                depreciation=revenue * 0.02  # ~2% depreciation
            )
            
            # Free CF
            fcf = self.forecast_free_cashflow(ocf["operating_cashflow"], revenue)
            
            forecasts.append({
                "period": i + 1,
                "revenue": revenue,
                "cogs": cogs,
                **wc,
                **ocf,
                **fcf
            })
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
            last_revenue = revenue
            last_cogs = cogs
        
        return pd.DataFrame(forecasts)
```

### 6.2 –°—Ü–µ–Ω–∞—Ä–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
# forecasting/scenarios.py

from dataclasses import dataclass
from typing import List, Dict
import numpy as np
from drivers.models import ForecastDrivers
from .driver_based import DriverBasedForecaster

@dataclass
class Scenario:
    """–°—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è"""
    name: str
    description: str
    drivers: ForecastDrivers
    probability: float = 0.33  # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏—è

class ScenarioEngine:
    """
    –î–≤–∏–∂–æ–∫ —Å—Ü–µ–Ω–∞—Ä–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è
    """
    
    def __init__(self, base_drivers: ForecastDrivers):
        self.base_drivers = base_drivers
    
    def create_scenarios(self) -> List[Scenario]:
        """
        –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤: Base, Optimistic, Pessimistic
        """
        scenarios = []
        
        # Base Case
        scenarios.append(Scenario(
            name="Base Case",
            description="–¢–µ–∫—É—â–∏–µ —Ç—Ä–µ–Ω–¥—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è",
            drivers=self.base_drivers,
            probability=0.50
        ))
        
        # Optimistic
        optimistic_drivers = self.base_drivers.model_copy(deep=True)
        optimistic_drivers.working_capital.dso_days *= 0.85  # DSO -15%
        optimistic_drivers.working_capital.dpo_days *= 1.1   # DPO +10%
        optimistic_drivers.revenue.revenue_growth_pct *= 1.2 # Growth +20%
        
        scenarios.append(Scenario(
            name="Optimistic",
            description="–£–ª—É—á—à–µ–Ω–∏–µ —Å–±–æ—Ä–∞ –¥–µ–±–∏—Ç–æ—Ä–∫–∏, —Ä–æ—Å—Ç –ø—Ä–æ–¥–∞–∂",
            drivers=optimistic_drivers,
            probability=0.25
        ))
        
        # Pessimistic
        pessimistic_drivers = self.base_drivers.model_copy(deep=True)
        pessimistic_drivers.working_capital.dso_days *= 1.2   # DSO +20%
        pessimistic_drivers.working_capital.dio_days *= 1.15  # DIO +15%
        pessimistic_drivers.revenue.revenue_growth_pct *= 0.5 # Growth -50%
        
        scenarios.append(Scenario(
            name="Pessimistic",
            description="–£—Ö—É–¥—à–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π, –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ —Ä–æ—Å—Ç–∞",
            drivers=pessimistic_drivers,
            probability=0.25
        ))
        
        return scenarios
    
    def run_monte_carlo(
        self, 
        historical_data, 
        n_simulations: int = 1000,
        periods: int = 12
    ) -> Dict:
        """
        Monte Carlo —Å–∏–º—É–ª—è—Ü–∏—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è outcomes
        
        Returns:
            Dict —Å percentiles –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
        """
        results = []
        
        for _ in range(n_simulations):
            # –°–ª—É—á–∞–π–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –¥—Ä–∞–π–≤–µ—Ä–æ–≤
            drivers = self.base_drivers.model_copy(deep=True)
            
            # ¬±20% —Å–ª—É—á–∞–π–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
            drivers.working_capital.dso_days *= np.random.uniform(0.8, 1.2)
            drivers.working_capital.dpo_days *= np.random.uniform(0.8, 1.2)
            drivers.working_capital.dio_days *= np.random.uniform(0.8, 1.2)
            drivers.revenue.revenue_growth_pct *= np.random.uniform(0.5, 1.5)
            
            forecaster = DriverBasedForecaster(drivers)
            forecast = forecaster.generate_forecast(historical_data, periods)
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Ç–æ–≥–æ–≤—ã–π FCF
            total_fcf = forecast['free_cashflow'].sum()
            results.append(total_fcf)
        
        results = np.array(results)
        
        return {
            "mean": results.mean(),
            "std": results.std(),
            "p5": np.percentile(results, 5),
            "p25": np.percentile(results, 25),
            "p50": np.percentile(results, 50),
            "p75": np.percentile(results, 75),
            "p95": np.percentile(results, 95),
            "min": results.min(),
            "max": results.max()
        }
```

---

## 7. üñ•Ô∏è UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 7.1 –§–æ—Ä–º–∞ –≤–≤–æ–¥–∞ –¥—Ä–∞–π–≤–µ—Ä–æ–≤

```python
# ui/driver_input.py

import streamlit as st
from drivers.models import (
    WorkingCapitalDrivers, 
    RevenueDrivers, 
    Industry,
    ForecastDrivers
)

def render_driver_input_form() -> ForecastDrivers:
    """
    Streamlit —Ñ–æ—Ä–º–∞ –¥–ª—è –≤–≤–æ–¥–∞ –¥—Ä–∞–π–≤–µ—Ä–æ–≤
    """
    st.subheader("üìä –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã")
    
    # –í—ã–±–æ—Ä –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ (–¥–ª—è –±–µ–Ω—á–º–∞—Ä–∫–æ–≤)
    industry = st.selectbox(
        "–ò–Ω–¥—É—Å—Ç—Ä–∏—è",
        options=[i.value for i in Industry],
        help="–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω–¥—É—Å—Ç—Ä–∏—é –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –±–µ–Ω—á–º–∞—Ä–∫–∞–º–∏"
    )
    
    # Working Capital Drivers
    st.markdown("### üí∞ –û–±–æ—Ä–æ—Ç–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª")
    
    col1, col2, col3 = st.columns(3)
    
    with col1:
        dso = st.number_input(
            "DSO (–¥–Ω–µ–π)",
            min_value=0.0,
            max_value=365.0,
            value=45.0,
            help="Days Sales Outstanding - —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Å–±–æ—Ä–∞ –¥–µ–±–∏—Ç–æ—Ä–∫–∏"
        )
    
    with col2:
        dpo = st.number_input(
            "DPO (–¥–Ω–µ–π)",
            min_value=0.0,
            max_value=365.0,
            value=30.0,
            help="Days Payable Outstanding - —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–ø–ª–∞—Ç—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º"
        )
    
    with col3:
        dio = st.number_input(
            "DIO (–¥–Ω–µ–π)",
            min_value=0.0,
            max_value=365.0,
            value=60.0,
            help="Days Inventory Outstanding - —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–ø–∞—Å–æ–≤"
        )
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π CCC
    ccc = dso + dio - dpo
    st.metric(
        "Cash Conversion Cycle (CCC)", 
        f"{ccc:.0f} –¥–Ω–µ–π",
        help="CCC = DSO + DIO - DPO. –ß–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –ª—É—á—à–µ."
    )
    
    # Revenue Drivers
    st.markdown("### üìà –í—ã—Ä—É—á–∫–∞")
    
    col1, col2 = st.columns(2)
    
    with col1:
        revenue_growth = st.number_input(
            "–†–æ—Å—Ç –≤—ã—Ä—É—á–∫–∏ (%)",
            min_value=-100.0,
            max_value=500.0,
            value=10.0,
            help="–û–∂–∏–¥–∞–µ–º—ã–π –≥–æ–¥–æ–≤–æ–π —Ä–æ—Å—Ç –≤—ã—Ä—É—á–∫–∏"
        )
    
    with col2:
        gross_margin = st.number_input(
            "–í–∞–ª–æ–≤–∞—è –º–∞—Ä–∂–∞ (%)",
            min_value=0.0,
            max_value=100.0,
            value=35.0,
            help="–í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å / –í—ã—Ä—É—á–∫–∞"
        )
    
    # CapEx (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    with st.expander("‚öôÔ∏è CapEx (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)"):
        capex_pct = st.number_input(
            "CapEx (% –æ—Ç –≤—ã—Ä—É—á–∫–∏)",
            min_value=0.0,
            max_value=100.0,
            value=5.0
        )
    
    # –°–æ–±–∏—Ä–∞–µ–º –º–æ–¥–µ–ª—å
    drivers = ForecastDrivers(
        working_capital=WorkingCapitalDrivers(
            dso_days=dso,
            dpo_days=dpo,
            dio_days=dio
        ),
        revenue=RevenueDrivers(
            revenue_growth_pct=revenue_growth,
            gross_margin_pct=gross_margin
        ),
        industry=Industry(industry)
    )
    
    return drivers
```

### 7.2 –î–∞—à–±–æ—Ä–¥ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

```python
# ui/dashboard.py

import streamlit as st
import plotly.express as px
import plotly.graph_objects as go
import pandas as pd

def render_cashflow_dashboard(forecast_df: pd.DataFrame):
    """
    –î–∞—à–±–æ—Ä–¥ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø—Ä–æ–≥–Ω–æ–∑–∞ Cash Flow
    """
    st.subheader("üìä –ü—Ä–æ–≥–Ω–æ–∑ Cash Flow")
    
    # Waterfall Chart –¥–ª—è Operating CF
    fig_waterfall = go.Figure(go.Waterfall(
        name="Operating Cash Flow",
        orientation="v",
        x=["–í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å", "–ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è", "Œî –î–µ–±–∏—Ç–æ—Ä–∫–∞", 
           "Œî –ö—Ä–µ–¥–∏—Ç–æ—Ä–∫–∞", "Œî –ó–∞–ø–∞—Å—ã", "Operating CF"],
        y=[
            forecast_df['gross_profit'].sum(),
            forecast_df['depreciation'].sum(),
            -forecast_df['delta_ar'].sum(),
            forecast_df['delta_ap'].sum(),
            -forecast_df['delta_inventory'].sum(),
            0  # Total
        ],
        measure=["relative", "relative", "relative", 
                 "relative", "relative", "total"],
        connector={"line": {"color": "rgb(63, 63, 63)"}}
    ))
    
    fig_waterfall.update_layout(
        title="–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ Operating Cash Flow",
        showlegend=False
    )
    
    st.plotly_chart(fig_waterfall, use_container_width=True)
    
    # Line Chart: Revenue vs Cash Flow
    fig_lines = go.Figure()
    
    fig_lines.add_trace(go.Scatter(
        x=forecast_df['period'],
        y=forecast_df['revenue'],
        name="–í—ã—Ä—É—á–∫–∞",
        line=dict(color='blue')
    ))
    
    fig_lines.add_trace(go.Scatter(
        x=forecast_df['period'],
        y=forecast_df['operating_cashflow'],
        name="Operating CF",
        line=dict(color='green')
    ))
    
    fig_lines.add_trace(go.Scatter(
        x=forecast_df['period'],
        y=forecast_df['free_cashflow'],
        name="Free CF",
        line=dict(color='orange')
    ))
    
    fig_lines.update_layout(
        title="–î–∏–Ω–∞–º–∏–∫–∞ Cash Flow",
        xaxis_title="–ü–µ—Ä–∏–æ–¥",
        yaxis_title="–°—É–º–º–∞"
    )
    
    st.plotly_chart(fig_lines, use_container_width=True)
    
    # Metrics
    col1, col2, col3, col4 = st.columns(4)
    
    with col1:
        st.metric(
            "Œ£ Operating CF",
            f"{forecast_df['operating_cashflow'].sum():,.0f}"
        )
    
    with col2:
        st.metric(
            "Œ£ Free CF",
            f"{forecast_df['free_cashflow'].sum():,.0f}"
        )
    
    with col3:
        st.metric(
            "Avg CCC",
            f"{forecast_df['ccc_days'].mean():.1f} –¥–Ω–µ–π"
        )
    
    with col4:
        conversion = (forecast_df['free_cashflow'].sum() / 
                     forecast_df['revenue'].sum() * 100)
        st.metric(
            "FCF/Revenue",
            f"{conversion:.1f}%"
        )


def render_scenario_comparison(scenarios_results: dict):
    """
    –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
    """
    st.subheader("üéØ –°—Ü–µ–Ω–∞—Ä–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ")
    
    # Bar chart —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    names = list(scenarios_results.keys())
    values = [r['total_fcf'] for r in scenarios_results.values()]
    
    fig = px.bar(
        x=names,
        y=values,
        title="Free Cash Flow –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—è–º",
        labels={"x": "–°—Ü–µ–Ω–∞—Ä–∏–π", "y": "Free Cash Flow"}
    )
    
    st.plotly_chart(fig, use_container_width=True)


def render_monte_carlo_results(mc_results: dict):
    """
    –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Monte Carlo
    """
    st.subheader("üé≤ Monte Carlo —Å–∏–º—É–ª—è—Ü–∏—è")
    
    col1, col2 = st.columns(2)
    
    with col1:
        st.metric("–°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ FCF", f"{mc_results['mean']:,.0f}")
        st.metric("–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ", f"{mc_results['std']:,.0f}")
    
    with col2:
        st.metric("5-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å (worst case)", f"{mc_results['p5']:,.0f}")
        st.metric("95-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å (best case)", f"{mc_results['p95']:,.0f}")
    
    # Confidence interval
    st.info(f"""
    üìä –° 90% —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é FCF –±—É–¥–µ—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ:
    **{mc_results['p5']:,.0f}** ‚Äî **{mc_results['p95']:,.0f}**
    """)
```

---

## 8. üóìÔ∏è –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Phase 1: MVP –¥—Ä–∞–π–≤–µ—Ä–æ–≤ (2-3 –Ω–µ–¥–µ–ª–∏)

| –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –°—Ä–æ–∫ |
|--------|-----------|-----------|------|
| Pydantic –º–æ–¥–µ–ª–∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ | üî¥ High | ‚≠ê‚≠ê | 2 –¥–Ω—è |
| UI —Ñ–æ—Ä–º–∞ –≤–≤–æ–¥–∞ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ | üî¥ High | ‚≠ê‚≠ê | 3 –¥–Ω—è |
| –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä WC (DSO/DPO/DIO/CCC) | üî¥ High | ‚≠ê‚≠ê | 2 –¥–Ω—è |
| Driver-based forecaster | üî¥ High | ‚≠ê‚≠ê‚≠ê | 4 –¥–Ω—è |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ app.py | üî¥ High | ‚≠ê‚≠ê | 2 –¥–Ω—è |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | üî¥ High | ‚≠ê‚≠ê | 2 –¥–Ω—è |

**–†–µ–∑—É–ª—å—Ç–∞—Ç Phase 1:** –ú–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä—ã –∏ –ø–æ–ª—É—á–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑

### Phase 2: AI –∞–≥–µ–Ω—Ç—ã (2-3 –Ω–µ–¥–µ–ª–∏)

| –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –°—Ä–æ–∫ |
|--------|-----------|-----------|------|
| Driver Agent (–∞–Ω–∞–ª–∏–∑ –¥—Ä–∞–π–≤–µ—Ä–æ–≤) | üü° Medium | ‚≠ê‚≠ê‚≠ê | 4 –¥–Ω—è |
| Explainer Agent (–æ–±—ä—è—Å–Ω–µ–Ω–∏—è) | üü° Medium | ‚≠ê‚≠ê | 3 –¥–Ω—è |
| Industry benchmarks JSON | üü° Medium | ‚≠ê | 1 –¥–µ–Ω—å |
| AI —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –≤ UI | üü° Medium | ‚≠ê‚≠ê | 3 –¥–Ω—è |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ AI | üü° Medium | ‚≠ê‚≠ê | 2 –¥–Ω—è |

**–†–µ–∑—É–ª—å—Ç–∞—Ç Phase 2:** AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥—Ä–∞–π–≤–µ—Ä—ã –∏ –¥–∞—ë—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### Phase 3: –°—Ü–µ–Ω–∞—Ä–∏–∏ (2 –Ω–µ–¥–µ–ª–∏)

| –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –°—Ä–æ–∫ |
|--------|-----------|-----------|------|
| Scenario Engine | üü¢ Low | ‚≠ê‚≠ê‚≠ê | 3 –¥–Ω—è |
| Monte Carlo —Å–∏–º—É–ª—è—Ü–∏—è | üü¢ Low | ‚≠ê‚≠ê‚≠ê | 3 –¥–Ω—è |
| UI —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ | üü¢ Low | ‚≠ê‚≠ê | 3 –¥–Ω—è |
| Dashboard –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ | üü¢ Low | ‚≠ê‚≠ê | 3 –¥–Ω—è |

**–†–µ–∑—É–ª—å—Ç–∞—Ç Phase 3:** –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç

---

## 9. üìö –£—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### –ß—Ç–æ –∏–∑—É—á–∏—Ç—å –ø–æ —Ö–æ–¥—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. **Working Capital Management**
   - [Wall Street Prep - Working Capital](https://www.wallstreetprep.com/knowledge/working-capital/)
   - [Investopedia - Cash Conversion Cycle](https://www.investopedia.com/terms/c/cashconversioncycle.asp)

2. **Driver-Based Planning**
   - [FP&A Trends - Driver-Based Forecasting](https://fpa-trends.com/)
   - –ö–Ω–∏–≥–∞: "Financial Planning & Analysis and Performance Management" - Jack Alexander

3. **Python –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤**
   - [Pandas –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö](https://pandas.pydata.org/docs/user_guide/timeseries.html)
   - [Plotly –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤](https://plotly.com/python/financial-charts/)

4. **AI/ML –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è**
   - [Prophet –æ—Ç Meta](https://facebook.github.io/prophet/)
   - [XGBoost –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤](https://xgboost.readthedocs.io/)

---

## 10. ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

### MVP (Phase 1)
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ DSO, DPO, DIO
- [ ] –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç CCC
- [ ] –ü—Ä–æ–≥–Ω–æ–∑ Cash Flow —É—á–∏—Ç—ã–≤–∞–µ—Ç –¥—Ä–∞–π–≤–µ—Ä—ã
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î

### Full Product (Phase 3)
- [ ] AI –¥–∞—ë—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –¥—Ä–∞–π–≤–µ—Ä–æ–≤
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–º–∏ –±–µ–Ω—á–º–∞—Ä–∫–∞–º–∏
- [ ] What-if —Å—Ü–µ–Ω–∞—Ä–∏–∏ (Optimistic/Base/Pessimistic)
- [ ] Monte Carlo –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–æ–≤
- [ ] –ü–æ–Ω—è—Ç–Ω—ã–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- [ ] –¢–µ–∫—Å—Ç–æ–≤–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: –§–µ–≤—Ä–∞–ª—å 2026*
*–í–µ—Ä—Å–∏—è: 2.0-draft*