# 📊 Cash Flow Planner - Обзор проекта

## 🎯 Главная идея

Образовательный проект для изучения **OpenAI Agents SDK** и **AutoGen** через создание реального приложения для прогнозирования денежных потоков.

### Распределение ролей:

```
┌─────────────────────────────────────────────────────────┐
│  ИНФРАСТРУКТУРА (написано Claude)                       │
│  ✅ Streamlit UI                                        │
│  ✅ База данных SQLite                                  │
│  ✅ Загрузка файлов (CSV/Excel)                         │
│  ✅ Сохранение сценариев                                │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│  AI АГЕНТЫ (пишет студент по заданиям)                  │
│  📝 Задание 1: OpenAI Agent для прогноза                │
│  📝 Задание 2: Multi-Agent система (AutoGen)            │
└─────────────────────────────────────────────────────────┘
```

---

## 📁 Структура проекта

```
fcf_planner/
│
├── 📱 ПРИЛОЖЕНИЕ (готово)
│   ├── app.py                    # Streamlit интерфейс
│   ├── config.py                 # Конфигурация
│   └── requirements.txt          # Зависимости
│
├── 🔧 ИНФРАСТРУКТУРА (готово)
│   └── core/
│       ├── io_historical.py      # Загрузка CSV/Excel
│       ├── db.py                 # Работа с БД
│       └── models.py             # SQLAlchemy модели
│
├── 🤖 AI АГЕНТЫ (задания студента)
│   └── agents/
│       ├── forecast_agent.py     # ЗАДАНИЕ 1 ← НАЧНИТЕ ЗДЕСЬ
│       └── optimization_agent.py # ЗАДАНИЕ 2
│
├── 📚 ОБУЧАЮЩИЕ МАТЕРИАЛЫ
│   ├── tasks/
│   │   ├── TASK_01_FORECAST_AGENT.md       # Задание 1
│   │   └── TASK_02_MULTIAGENT_SYSTEM.md    # Задание 2
│   ├── QUICK_START.md            # Быстрый старт (15 мин)
│   ├── LEARNING_PATH.md          # План обучения
│   └── README.md                 # Главная документация
│
└── 📊 ДАННЫЕ
    └── data/
        └── sample_cashflow.csv   # Тестовые данные
```

---

## 🎓 Что вы будете изучать

### Задание 1: OpenAI Agents SDK (2-3 часа)

**Файл:** `agents/forecast_agent.py`

**Навыки:**
- Инициализация OpenAI клиента
- Написание промптов для финансового анализа
- Обработка ответов от LLM
- Извлечение структурированных данных (чисел) из текста
- Работа с pandas (группировка, агрегация, временные ряды)

**Результат:**
AI-агент, который анализирует исторические данные за 3 месяца и делает прогноз на следующий месяц для каждой категории cash flow.

---

### Задание 2: AutoGen Multi-Agent (3-4 часа)

**Файл:** `agents/optimization_agent.py`

**Навыки:**
- Создание multi-agent систем
- Организация GroupChat между агентами
- Определение ролей (Analyst, Critic, Optimizer)
- Извлечение результатов из диалога
- Обработка ошибок в распределенных системах

**Результат:**
Система из 3 агентов, которые совместно улучшают прогноз через обсуждение.

---

## 🚀 Как начать?

### Вариант 1: Быстрый старт (15 минут)

```bash
# Прочитайте это первым
cat QUICK_START.md

# Следуйте инструкциям
# → установка
# → настройка
# → запуск
```

### Вариант 2: Полный образовательный путь

```bash
# Изучите план обучения
cat LEARNING_PATH.md

# Затем начинайте с Задания 1
cat tasks/TASK_01_FORECAST_AGENT.md
```

---

## 📊 Как работает приложение

### Workflow:

```
1. Пользователь загружает файл
   ↓
2. Приложение парсит данные (core/io_historical.py)
   ↓
3. Пользователь нажимает "Рассчитать прогноз"
   ↓
4. Вызывается ваш AI-агент (agents/forecast_agent.py)
   ↓
5. Агент анализирует данные и возвращает прогноз
   ↓
6. Приложение показывает таблицу с результатами
   ↓
7. Пользователь может скорректировать прогноз вручную
   ↓
8. Сохранение в БД (core/db.py)
```

---

## 🛠 Технологический стек

### Уже настроено:

| Компонент | Технология | Статус |
|-----------|-----------|--------|
| **Frontend** | Streamlit | ✅ Готово |
| **Database** | SQLite + SQLAlchemy | ✅ Готово |
| **File I/O** | Pandas + openpyxl | ✅ Готово |
| **Environment** | python-dotenv | ✅ Готово |

### Вам нужно добавить:

| Компонент | Технология | Задание |
|-----------|-----------|---------|
| **Single Agent** | OpenAI API | 📝 Задание 1 |
| **Multi-Agent** | AutoGen | 📝 Задание 2 |

---

## 📈 Данные

### Формат входного файла:

```csv
date,category,amount
2024-09-01,Поступления от клиентов,1500000
2024-09-10,Платежи поставщикам,-450000
2024-09-12,Зарплата,-320000
...
```

### Категории в тестовых данных:

- Поступления от клиентов (доход)
- Платежи поставщикам (расход)
- Зарплата (расход)
- Аренда (расход)
- Налоги (расход)
- Маркетинг (расход)
- IT услуги (расход)

### Период:
Сентябрь - Ноябрь 2024

### Прогноз:
Декабрь 2024

---

## 🎯 Критерии успеха

### После Задания 1:

- ✅ Приложение запускается без ошибок
- ✅ Можно загрузить CSV/Excel файл
- ✅ AI-агент делает прогноз для всех категорий
- ✅ Прогноз — это числа (не текст)
- ✅ Можно скорректировать вручную
- ✅ Можно сохранить в БД
- ✅ История сценариев работает

### После Задания 2:

- ✅ Multi-agent система работает
- ✅ Видны диалоги между агентами
- ✅ Финальный прогноз извлекается корректно
- ✅ Результаты multi-agent отличаются от simple-agent
- ✅ Можно сравнить оба подхода

---

## 🔍 Интересные детали

### 1. Почему Streamlit?
- Быстрый прототип без написания HTML/CSS/JS
- Встроенные компоненты (upload, data editor, charts)
- Автоматический reload при изменениях

### 2. Почему SQLite?
- Не требует установки сервера
- Один файл базы данных
- Легко мигрировать на PostgreSQL потом

### 3. Почему два задания?
- Задание 1: простое, чтобы понять основы
- Задание 2: сложное, чтобы изучить multi-agent паттерны

### 4. Почему cash flow?
- Реальная бизнес-задача
- Понятная логика (доходы - расходы)
- Есть категории и временные ряды
- AI действительно может помочь с прогнозом

---

## 📚 Дополнительные возможности

После выполнения обоих заданий можно:

### 🎨 UI/UX улучшения:
- Графики (Plotly)
- Сравнение сценариев
- Экспорт в Excel
- Темная тема

### 🤖 AI улучшения:
- Добавить агента для обнаружения аномалий
- Function calling для структурированных данных
- Использовать RAG для исторического контекста
- Sentiment analysis комментариев

### 🔧 Engineering:
- Юнит-тесты (pytest)
- CI/CD (GitHub Actions)
- Docker контейнеры
- Деплой (Streamlit Cloud, Render)

### 💼 Business:
- Авторизация пользователей
- Multi-tenancy
- Email уведомления
- Интеграция с ERP

---

## 🆘 Помощь и поддержка

### Если что-то не работает:

1. **Проверьте QUICK_START.md** — там чеклист
2. **Посмотрите логи** — Streamlit показывает ошибки
3. **Спросите Claude** — я помогу!

### Типичные ошибки:

- ❌ API ключ не установлен → проверьте `.env`
- ❌ Модуль не найден → активируйте `venv`
- ❌ Импорт не работает → проверьте структуру папок
- ❌ AI не возвращает число → улучшите промпт

---

## 🎓 Образовательная ценность

Этот проект учит **не только AI**, но и:

- Структурирование Python проектов
- Работа с виртуальными окружениями
- Управление зависимостями
- Работа с pandas (группировка, агрегация, даты)
- Работа с БД (SQLAlchemy ORM)
- Создание веб-приложений (Streamlit)
- Обработка ошибок
- Логирование
- Best practices в коде

---

## 🚀 Начинайте!

```bash
# Шаг 1: Быстрый старт
cat QUICK_START.md

# Шаг 2: Задание 1
cat tasks/TASK_01_FORECAST_AGENT.md

# Шаг 3: Создайте файл
touch agents/forecast_agent.py

# Шаг 4: Начинайте писать код!
```

---

**Удачи в обучении! Вы создаете что-то полезное!** 🎉
